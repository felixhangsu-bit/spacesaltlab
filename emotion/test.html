<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æƒ…ç»ªæ™ºåŠ›æµ‹è¯„ | å®‡å®™è®¤çŸ¥ç›ç©¶æ‰€</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root { --primary: #6366f1; --primary-dark: #4f46e5; --primary-light: #a5b4fc; --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%); --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --text-muted: #64748b; --border: #e2e8f0; --shadow: 0 4px 20px rgba(0,0,0,0.08); --radius: 16px; }
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Noto Sans SC', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
.page { display: none; min-height: 100vh; }
.page.active { display: block; }
#testPage { background: var(--bg); padding: 20px; }
.test-container { max-width: 700px; margin: 0 auto; }
.test-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
.back-btn { display: flex; align-items: center; gap: 6px; background: none; border: none; color: var(--text-muted); font-size: 14px; cursor: pointer; padding: 8px 12px; border-radius: 8px; transition: all 0.2s; }
.back-btn:hover { background: white; color: var(--text); }
.progress-wrap { text-align: right; }
.progress-text { font-size: 13px; color: var(--text-muted); margin-bottom: 6px; }
.progress-bar { width: 180px; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
.progress-fill { height: 100%; background: var(--gradient); border-radius: 3px; transition: width 0.3s; }
.question-card { background: var(--card); border-radius: var(--radius); padding: 40px; box-shadow: var(--shadow); }
.dim-tag { display: inline-block; padding: 6px 14px; border-radius: 20px; font-size: 12px; font-weight: 500; margin-bottom: 16px; }
.q-num { font-size: 13px; color: var(--text-muted); margin-bottom: 10px; }
.q-text { font-size: 20px; font-weight: 600; line-height: 1.5; margin-bottom: 32px; }
.options { display: flex; flex-direction: column; gap: 12px; }
.opt { display: flex; align-items: center; gap: 14px; padding: 16px 20px; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; transition: all 0.2s; }
.opt:hover { border-color: var(--primary-light); background: #fafaff; }
.opt.selected { border-color: var(--primary); background: linear-gradient(135deg, #ede9fe 0%, #e0e7ff 100%); }
.opt-radio { width: 22px; height: 22px; border: 2px solid var(--border); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.2s; }
.opt.selected .opt-radio { border-color: var(--primary); background: var(--primary); }
.opt.selected .opt-radio::after { content: ''; width: 8px; height: 8px; background: white; border-radius: 50%; }
.opt-text { font-size: 15px; }
.nav-btns { display: flex; justify-content: space-between; margin-top: 28px; }
.nav-btn { padding: 12px 28px; border-radius: 10px; font-size: 15px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
.nav-btn.secondary { background: white; border: 2px solid var(--border); color: var(--text); }
.nav-btn.secondary:hover { border-color: var(--primary); color: var(--primary); }
.nav-btn.primary { background: var(--primary); border: none; color: white; }
.nav-btn.primary:hover { background: var(--primary-dark); }
.nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }
#resultPage { background: linear-gradient(180deg, #667eea 0%, #764ba2 40%, var(--bg) 40%); }
.result-container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
.result-header { text-align: center; color: white; padding: 20px 0 60px; }
.result-header h1 { font-size: 28px; margin-bottom: 8px; }
.result-header p { opacity: 0.9; }
.card { background: var(--card); border-radius: var(--radius); padding: 32px; box-shadow: var(--shadow); margin-bottom: 20px; }
.section-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; margin-bottom: 16px; }
.section-title { font-size: 18px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; }
.eq-score { font-size: 64px; font-weight: 700; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
.eq-level { text-align: center; padding: 8px 24px; background: var(--gradient); color: white; border-radius: 20px; display: inline-block; margin: 16px auto; font-weight: 600; }
.eq-desc { text-align: center; color: var(--text-muted); font-size: 15px; line-height: 1.8; }
.stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-top: 20px; }
.stat-card { padding: 16px; background: #f8fafc; border-radius: 12px; text-align: center; }
.stat-value { font-size: 24px; font-weight: 700; color: var(--primary); }
.stat-label { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
.dim-item { margin-bottom: 20px; }
.dim-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.dim-name { display: flex; align-items: center; gap: 8px; font-weight: 500; }
.dim-icon { width: 28px; height: 28px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; }
.dim-score { font-weight: 600; color: var(--primary); }
.dim-bar { height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; margin-bottom: 12px; }
.dim-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s; }
.level-badge { padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; }
.level-high { background: #d1fae5; color: #059669; }
.level-medium { background: #fef3c7; color: #d97706; }
.level-low { background: #fee2e2; color: #dc2626; }
.dim-analysis { font-size: 14px; color: var(--text-muted); line-height: 1.7; margin-top: 8px; padding: 12px; background: #f8fafc; border-radius: 8px; }
.tip-item { display: flex; gap: 14px; padding: 16px; background: #f8fafc; border-radius: 12px; margin-bottom: 10px; border-left: 4px solid var(--primary); }
.tip-num { width: 26px; height: 26px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; flex-shrink: 0; }
.tip-text { font-size: 14px; color: var(--text-muted); line-height: 1.6; }
.download-section { text-align: center; padding: 32px; }
.download-btn { display: inline-flex; align-items: center; gap: 10px; padding: 14px 28px; background: var(--gradient); color: white; border: none; border-radius: 12px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
.download-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(102,126,234,0.35); }
.restart-btn { display: inline-flex; align-items: center; gap: 6px; margin-top: 14px; padding: 10px 20px; background: transparent; border: 2px solid var(--border); border-radius: 10px; font-size: 13px; color: var(--text-muted); cursor: pointer; transition: all 0.2s; }
.restart-btn:hover { border-color: var(--primary); color: var(--primary); }
.loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999; opacity: 0; visibility: hidden; transition: all 0.3s; }
.loading.show { opacity: 1; visibility: visible; }
.loading-box { background: white; padding: 36px; border-radius: 16px; text-align: center; }
.spinner { width: 44px; height: 44px; border: 4px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px; }
@keyframes spin { to { transform: rotate(360deg); } }
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 9999; opacity: 0; visibility: hidden; transition: all 0.3s; }
.modal-overlay.show { opacity: 1; visibility: visible; }
.modal-content { background: white; padding: 36px; border-radius: 20px; max-width: 400px; width: 90%; text-align: center; transform: scale(0.9); transition: transform 0.3s; }
.modal-overlay.show .modal-content { transform: scale(1); }
.modal-icon { font-size: 48px; margin-bottom: 16px; }
.modal-content h3 { font-size: 22px; font-weight: 700; margin-bottom: 12px; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.modal-content > p { color: var(--text-muted); font-size: 14px; line-height: 1.6; margin-bottom: 20px; }
.modal-tests { background: #f8fafc; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
.modal-test-item { padding: 10px; font-size: 14px; color: var(--text); border-bottom: 1px solid var(--border); }
.modal-test-item:last-child { border-bottom: none; }
.modal-tip { font-size: 13px; color: var(--primary); font-weight: 500; margin-bottom: 20px; }
.modal-buttons { display: flex; flex-direction: column; gap: 10px; }
.modal-btn { padding: 14px 24px; border-radius: 10px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; }
.modal-btn.primary { background: var(--gradient); color: white; }
.modal-btn.secondary { background: transparent; border: 2px solid var(--border); color: var(--text-muted); }
.more-tests-btn { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-color: #f59e0b; color: #92400e; }
.chart-container { max-width: 350px; margin: 20px auto; }
@media (max-width: 640px) { .stat-grid { grid-template-columns: repeat(2, 1fr); } .question-card { padding: 28px 20px; } .q-text { font-size: 18px; } }

/* å¹´é¾„è¾“å…¥é¡µé¢æ ·å¼ */
.age-page { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; }
.age-card { background: white; border-radius: 24px; padding: 48px 40px; max-width: 450px; width: 100%; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.15); }
.age-icon { font-size: 64px; margin-bottom: 20px; }
.age-title { font-size: 24px; font-weight: 700; margin-bottom: 12px; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.age-desc { color: var(--text-muted); font-size: 14px; line-height: 1.7; margin-bottom: 32px; }
.age-input-wrap { margin-bottom: 32px; }
.age-input { width: 100%; padding: 16px 20px; font-size: 18px; border: 2px solid var(--border); border-radius: 12px; text-align: center; outline: none; transition: all 0.2s; }
.age-input:focus { border-color: var(--primary); }
.age-input::placeholder { color: #cbd5e1; }
.age-hint { font-size: 12px; color: var(--text-muted); margin-top: 8px; }
.age-start-btn { width: 100%; padding: 16px; background: var(--gradient); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
.age-start-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(102,126,234,0.35); }
.age-start-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }

/* å¿ƒç†å¹´é¾„å¡ç‰‡æ ·å¼ */
.psych-age-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 20px; }
.psych-age-card { padding: 20px; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 16px; text-align: center; border: 1px solid var(--border); }
.psych-age-icon { font-size: 32px; margin-bottom: 8px; }
.psych-age-label { font-size: 13px; color: var(--text-muted); margin-bottom: 4px; }
.psych-age-value { font-size: 28px; font-weight: 700; color: var(--primary); }
.psych-age-suffix { font-size: 14px; color: var(--text-muted); }
.psych-age-desc { font-size: 12px; color: var(--text-muted); margin-top: 8px; line-height: 1.5; }
.psych-age-main { padding: 32px; background: linear-gradient(135deg, #ede9fe 0%, #e0e7ff 100%); border-radius: 20px; text-align: center; margin-bottom: 20px; }
.psych-age-main-label { font-size: 14px; color: var(--text-muted); margin-bottom: 8px; }
.psych-age-main-value { font-size: 56px; font-weight: 700; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.psych-age-main-type { font-size: 18px; font-weight: 600; color: var(--primary); margin-top: 8px; }
.psych-age-main-desc { font-size: 14px; color: var(--text-muted); margin-top: 12px; line-height: 1.7; }
</style>
</head>
<body>

<div id="agePage" class="page active">
  <div class="age-page">
    <div class="age-card">
      <div class="age-icon">ğŸ§ </div>
      <div class="age-title">æƒ…ç»ªæ™ºåŠ›æµ‹è¯„</div>
      <div class="age-desc">åœ¨å¼€å§‹æµ‹è¯„ä¹‹å‰ï¼Œè¯·å…ˆè¾“å…¥æ‚¨çš„å®é™…å¹´é¾„ã€‚<br>è¿™å°†å¸®åŠ©æˆ‘ä»¬ä¸ºæ‚¨ç”Ÿæˆæ›´ç²¾å‡†çš„å¿ƒç†å¹´é¾„åˆ†ææŠ¥å‘Šã€‚</div>
      <div class="age-input-wrap">
        <input type="number" class="age-input" id="userAge" placeholder="è¯·è¾“å…¥æ‚¨çš„å¹´é¾„" min="12" max="100" onkeypress="if(event.key==='Enter')startTest()">
        <div class="age-hint">è¯·è¾“å…¥12-100ä¹‹é—´çš„æ•°å­—</div>
      </div>
      <button class="age-start-btn" id="startTestBtn" onclick="startTest()">å¼€å§‹æµ‹è¯„</button>
    </div>
  </div>
</div>

<div id="testPage" class="page">
  <div class="test-container">
    <div class="test-header">
      <button class="back-btn" onclick="exitTest()"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>é€€å‡ºæµ‹è¯•</button>
      <div class="progress-wrap">
        <div class="progress-text"><span id="current">1</span> / 40</div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
      </div>
    </div>
    <div class="question-card">
      <div class="dim-tag" id="dimTag" style="display:none">æƒ…ç»ªæ„ŸçŸ¥</div>
      <div class="q-num">é—®é¢˜ <span id="qNum">1</span></div>
      <div class="q-text" id="qText"></div>
      <div class="options" id="options"></div>
      <div class="nav-btns">
        <button class="nav-btn secondary" id="prevBtn" onclick="prevQ()">ä¸Šä¸€é¢˜</button>
        <button class="nav-btn primary" id="nextBtn" onclick="nextQ()">ä¸‹ä¸€é¢˜</button>
      </div>
    </div>
  </div>
</div>

<div id="resultPage" class="page">
  <div class="result-container">
    <div class="result-header"><h1>ğŸ§  æƒ…ç»ªæ™ºåŠ›æµ‹è¯„æŠ¥å‘Š</h1><p>å®‡å®™è®¤çŸ¥ç›ç©¶æ‰€ Â· Space Salt Lab</p></div>
    <div id="resultContent"></div>
  </div>
</div>

<div class="loading" id="loading"><div class="loading-box"><div class="spinner"></div><p>æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...</p></div></div>

<script>
let userAge = 0;

function startTest() {
  const ageInput = document.getElementById('userAge');
  const age = parseInt(ageInput.value);

  if (!age || age < 12 || age > 100) {
    alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„ï¼ˆ12-100å²ï¼‰');
    ageInput.focus();
    return;
  }

  userAge = age;
  document.getElementById('agePage').classList.remove('active');
  document.getElementById('testPage').classList.add('active');
}

// è®¡ç®—å¤šåœºæ™¯å¿ƒç†å¹´é¾„
function getPsychologicalAges(scores, realAge) {
  const total = scores.perceive + scores.facilitate + scores.understand + scores.manage;
  const maxScore = 160;

  // åŸºç¡€å¿ƒç†å¹´é¾„è®¡ç®—ï¼ˆæ ¹æ®æ€»ä½“æƒ…ç»ªæ™ºåŠ›ï¼‰
  const baseRatio = total / maxScore;

  // ä¸åŒåœºæ™¯çš„å¿ƒç†å¹´é¾„è®¡ç®—
  const scenes = {
    // èŒåœºå¿ƒç†å¹´é¾„ï¼šä¸»è¦çœ‹æƒ…ç»ªç®¡ç†å’Œæƒ…ç»ªè¿ç”¨
    workplace: {
      icon: 'ğŸ’¼',
      label: 'èŒåœºå¿ƒç†å¹´é¾„',
      score: (scores.manage * 0.5 + scores.facilitate * 0.3 + scores.understand * 0.2) / 40,
      desc: ''
    },
    // å®¶åº­å¿ƒç†å¹´é¾„ï¼šä¸»è¦çœ‹æƒ…ç»ªæ„ŸçŸ¥å’Œæƒ…ç»ªç®¡ç†
    family: {
      icon: 'ğŸ ',
      label: 'å®¶åº­å¿ƒç†å¹´é¾„',
      score: (scores.perceive * 0.4 + scores.manage * 0.4 + scores.understand * 0.2) / 40,
      desc: ''
    },
    // æ„Ÿæƒ…å¿ƒç†å¹´é¾„ï¼šä¸»è¦çœ‹æƒ…ç»ªæ„ŸçŸ¥å’Œæƒ…ç»ªç†è§£
    romance: {
      icon: 'ğŸ’•',
      label: 'æ„Ÿæƒ…å¿ƒç†å¹´é¾„',
      score: (scores.perceive * 0.4 + scores.understand * 0.35 + scores.facilitate * 0.25) / 40,
      desc: ''
    },
    // æŒ«æŠ˜å¿ƒç†å¹´é¾„ï¼šä¸»è¦çœ‹æƒ…ç»ªç®¡ç†å’Œæƒ…ç»ªè¿ç”¨
    adversity: {
      icon: 'ğŸŒŠ',
      label: 'æŒ«æŠ˜åº”å¯¹å¹´é¾„',
      score: (scores.manage * 0.5 + scores.facilitate * 0.3 + scores.understand * 0.2) / 40,
      desc: ''
    }
  };

  // æ ¹æ®å¾—åˆ†æ¯”ä¾‹è®¡ç®—å¿ƒç†å¹´é¾„
  Object.keys(scenes).forEach(key => {
    const ratio = scenes[key].score;
    let psychAge;

    if (ratio >= 0.85) {
      // éå¸¸æˆç†Ÿï¼Œå¿ƒç†å¹´é¾„é«˜äºå®é™…å¹´é¾„
      psychAge = Math.round(realAge + (ratio - 0.7) * 20);
    } else if (ratio >= 0.7) {
      // æˆç†Ÿï¼Œå¿ƒç†å¹´é¾„ç•¥é«˜äºå®é™…å¹´é¾„
      psychAge = Math.round(realAge + (ratio - 0.7) * 15);
    } else if (ratio >= 0.55) {
      // ç¬¦åˆå¹´é¾„
      psychAge = Math.round(realAge - (0.7 - ratio) * 8);
    } else if (ratio >= 0.4) {
      // ç•¥æ˜¾ç¨šå«©
      psychAge = Math.round(realAge - (0.7 - ratio) * 12);
    } else {
      // éœ€è¦æˆé•¿
      psychAge = Math.round(realAge - (0.7 - ratio) * 15);
    }

    // ç¡®ä¿å¿ƒç†å¹´é¾„åœ¨åˆç†èŒƒå›´å†…
    psychAge = Math.max(12, Math.min(80, psychAge));
    scenes[key].age = psychAge;

    // ç”Ÿæˆæè¿°
    const diff = psychAge - realAge;
    if (diff >= 8) {
      scenes[key].desc = 'è¿œè¶…åŒé¾„äººçš„æˆç†Ÿåº¦';
    } else if (diff >= 3) {
      scenes[key].desc = 'å±•ç°å‡ºè¶…è¶Šå¹´é¾„çš„æ™ºæ…§';
    } else if (diff >= -2) {
      scenes[key].desc = 'ä¸å®é™…å¹´é¾„ç›¸ç¬¦';
    } else if (diff >= -6) {
      scenes[key].desc = 'æœ‰æˆé•¿ç©ºé—´';
    } else {
      scenes[key].desc = 'éœ€è¦æ›´å¤šå†ç»ƒ';
    }
  });

  // è®¡ç®—ç»¼åˆå¿ƒç†å¹´é¾„
  const avgPsychAge = Math.round((scenes.workplace.age + scenes.family.age + scenes.romance.age + scenes.adversity.age) / 4);

  // ç»¼åˆå¿ƒç†å¹´é¾„ç±»å‹åˆ¤å®š
  let mainType, mainDesc;
  const diff = avgPsychAge - realAge;

  if (diff >= 10) {
    mainType = 'æ™ºæ…§é•¿è€…å‹';
    mainDesc = 'ä½ çš„æƒ…ç»ªæ™ºåŠ›è¿œè¶…åŒé¾„äººï¼Œåœ¨å„ç§åœºæ™¯ä¸‹éƒ½å±•ç°å‡ºå“è¶Šçš„æƒ…ç»ªè§‰å¯Ÿå’Œç®¡ç†èƒ½åŠ›ã€‚ä½ æ˜¯æœ‹å‹å’ŒåŒäº‹çœ¼ä¸­çš„"è€çµé­‚"ï¼Œæ€»èƒ½ç»™å‡ºæˆç†Ÿç¨³é‡çš„å»ºè®®ï¼Œæ˜¯å¤§å®¶ä¿¡èµ–çš„æƒ…æ„Ÿæ”¯æŸ±ã€‚';
  } else if (diff >= 5) {
    mainType = 'æˆç†Ÿç¨³é‡å‹';
    mainDesc = 'ä½ çš„æƒ…ç»ªæˆç†Ÿåº¦æ˜æ˜¾é«˜äºåŒé¾„äººï¼Œåœ¨é¢å¯¹å¤æ‚çš„äººé™…å…³ç³»å’Œæƒ…ç»ªæƒ…å¢ƒæ—¶ï¼Œä½ é€šå¸¸èƒ½ä¿æŒå†·é™å’Œç†æ€§ã€‚ä½ å–„äºç†è§£ä»–äººã€è°ƒèŠ‚æƒ…ç»ªï¼Œè¿™è®©ä½ åœ¨å·¥ä½œå’Œç”Ÿæ´»ä¸­éƒ½æ›´åŠ æ¸¸åˆƒæœ‰ä½™ã€‚';
  } else if (diff >= 0) {
    mainType = 'åŒé¾„ä¼˜ç§€å‹';
    mainDesc = 'ä½ çš„æƒ…ç»ªæ™ºåŠ›ä¸å®é™…å¹´é¾„ç›¸ç¬¦ï¼Œå¹¶ä¸”åœ¨æŸäº›æ–¹é¢å±•ç°å‡ºä¼˜äºåŒé¾„äººçš„ç‰¹è´¨ã€‚ä½ æ‡‚å¾—è¯†åˆ«å’Œç®¡ç†è‡ªå·±çš„æƒ…ç»ªï¼Œåœ¨äººé™…äº¤å¾€ä¸­è¡¨ç°å¾—ä½“ã€‚ç»§ç»­ä¿æŒï¼Œä½ æ­£åœ¨ç¨³æ­¥æˆé•¿ã€‚';
  } else if (diff >= -5) {
    mainType = 'æˆé•¿è¿›è¡Œå‹';
    mainDesc = 'ä½ æ­£åœ¨æƒ…ç»ªæ™ºåŠ›çš„æˆé•¿é“è·¯ä¸Šå‰è¡Œã€‚è™½ç„¶åœ¨æŸäº›æƒ…å¢ƒä¸‹å¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘æˆ–éš¾ä»¥æ§åˆ¶æƒ…ç»ªï¼Œä½†è¿™æ­£æ˜¯å­¦ä¹ å’Œæˆé•¿çš„æœºä¼šã€‚æ¯ä¸€æ¬¡æƒ…ç»ªä½“éªŒéƒ½æ˜¯æå‡çš„å¥‘æœºï¼Œç›¸ä¿¡ä½ ä¼šè¶Šæ¥è¶Šå¥½ã€‚';
  } else {
    mainType = 'æ½œåŠ›æ— é™å‹';
    mainDesc = 'ä½ çš„æƒ…ç»ªæ™ºåŠ›è¿˜æœ‰å¹¿é˜”çš„å‘å±•ç©ºé—´ï¼Œè¿™æ„å‘³ç€ä½ æœ‰ç€å·¨å¤§çš„æˆé•¿æ½œåŠ›ï¼ç›®å‰ä½ å¯èƒ½åœ¨æƒ…ç»ªè§‰å¯Ÿå’Œç®¡ç†æ–¹é¢é‡åˆ°ä¸€äº›æŒ‘æˆ˜ï¼Œä½†è¯·è®°ä½ï¼šæƒ…ç»ªæ™ºåŠ›æ˜¯å¯ä»¥é€šè¿‡å­¦ä¹ å’Œç»ƒä¹ æ¥æå‡çš„ã€‚æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„æˆé•¿èŠ‚å¥ï¼Œä½ æ­£ç«™åœ¨æˆé•¿çš„èµ·ç‚¹ä¸Šã€‚';
  }

  return {
    realAge,
    avgPsychAge,
    mainType,
    mainDesc,
    scenes
  };
}

// 40é“æƒ…ç»ªæ™ºåŠ›æµ‹è¯„é¢˜ç›®ï¼ˆåŸºäºMayer-Saloveyæ¨¡å‹ï¼‰
const questions = [
  // æƒ…ç»ªæ„ŸçŸ¥ Perceiving (10é¢˜)
  { dim: 'perceive', text: 'ä¸äººäº¤è°ˆæ—¶ï¼Œæˆ‘èƒ½å¤Ÿé€šè¿‡å¯¹æ–¹çš„é¢éƒ¨è¡¨æƒ…åˆ¤æ–­ä»–ä»¬çš„çœŸå®æ„Ÿå—', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«è‡ªå·±å½“å‰çš„æƒ…ç»ªçŠ¶æ€', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘èƒ½ä»ä»–äººçš„è¯­æ°”ä¸­å¯Ÿè§‰åˆ°ä»–ä»¬éšè—çš„æƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'çœ‹åˆ°ä¸€å¹…è‰ºæœ¯ä½œå“æ—¶ï¼Œæˆ‘èƒ½æ„Ÿå—åˆ°å…¶ä¸­è•´å«çš„æƒ…æ„Ÿ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘èƒ½æ³¨æ„åˆ°ä»–äººçš„å‘¼å¸èŠ‚å¥æˆ–å£°éŸ³å˜åŒ–ä¸­é€éœ²çš„æƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'å½“æˆ‘æ„Ÿåˆ°ä¸èˆ’æœæ—¶ï¼Œæˆ‘èƒ½å‡†ç¡®è¯´å‡ºæ˜¯ä»€ä¹ˆæƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘èƒ½å¯Ÿè§‰åˆ°ç¯å¢ƒä¸­çš„æƒ…ç»ªæ°›å›´å˜åŒ–', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'å¬éŸ³ä¹æ—¶ï¼Œæˆ‘èƒ½æ„Ÿå—åˆ°éŸ³ä¹æ‰€è¡¨è¾¾çš„æƒ…æ„Ÿ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘èƒ½åˆ†è¾¨å‡ºçœŸè¯šçš„å¾®ç¬‘å’Œç¤¼è²Œæ€§çš„å¾®ç¬‘', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'perceive', text: 'æˆ‘å¾ˆå®¹æ˜“è¢«ä»–äººçš„æƒ…ç»ªæ‰€æ„ŸæŸ“', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },

  // æƒ…ç»ªè¿ç”¨ Facilitating (10é¢˜)
  { dim: 'facilitate', text: 'æˆ‘ä¼šåˆ©ç”¨ç§¯æçš„å¿ƒæƒ…æ¥æ¿€å‘åˆ›é€ åŠ›', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'å½“éœ€è¦åšé‡è¦å†³å®šæ—¶ï¼Œæˆ‘ä¼šè€ƒè™‘è‡ªå·±çš„æ„Ÿå—', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æˆ‘èƒ½åˆ©ç”¨æƒ…ç»ªæ¥å¸®åŠ©è‡ªå·±é›†ä¸­æ³¨æ„åŠ›', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'å¿ƒæƒ…å¥½çš„æ—¶å€™ï¼Œæˆ‘çš„é—®é¢˜è§£å†³èƒ½åŠ›ä¼šæ›´å¼º', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æˆ‘ä¼šæ ¹æ®ä»»åŠ¡æ€§è´¨è°ƒæ•´è‡ªå·±çš„æƒ…ç»ªçŠ¶æ€', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æƒ…ç»ªä¼šå½±å“æˆ‘çœ‹å¾…é—®é¢˜çš„è§’åº¦', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æˆ‘ä¼šåœ¨æƒ…ç»ªä½è½æ—¶é€‰æ‹©é€‚åˆåæ€çš„ä»»åŠ¡æ¥å®Œæˆ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'åœ¨éœ€è¦åŒç†å¿ƒçš„æƒ…å†µä¸‹ï¼Œæˆ‘èƒ½è°ƒåŠ¨ç›¸åº”çš„æƒ…æ„Ÿ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æˆ‘ä¼šåˆ©ç”¨æƒ…ç»ªæ¥å¢å¼ºè®°å¿†åŠ›', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'facilitate', text: 'æˆ‘èƒ½é€šè¿‡æƒ³è±¡æ¥æ¿€å‘ç‰¹å®šçš„æƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },

  // æƒ…ç»ªç†è§£ Understanding (10é¢˜)
  { dim: 'understand', text: 'æˆ‘äº†è§£ä¸åŒæƒ…ç»ªä¹‹é—´çš„å…³ç³»å’Œå˜åŒ–è§„å¾‹', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘èƒ½ç†è§£ä¸ºä»€ä¹ˆæŸäº›æƒ…å†µä¼šå¼•å‘ç‰¹å®šçš„æƒ…ç»ªååº”', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘èƒ½é¢„æµ‹æŸä¸ªäº‹ä»¶å¯èƒ½å¼•èµ·çš„æƒ…ç»ªååº”', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘ç†è§£å¤æ‚æƒ…ç»ªï¼ˆå¦‚åˆçˆ±åˆæ¨ï¼‰æ˜¯å¦‚ä½•äº§ç”Ÿçš„', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘èƒ½åŒºåˆ†ç±»ä¼¼ä½†ä¸åŒçš„æƒ…ç»ªï¼ˆå¦‚æ„¤æ€’å’Œå¤±æœ›ï¼‰', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘äº†è§£æƒ…ç»ªä¼šå¦‚ä½•éšæ—¶é—´å˜åŒ–', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘èƒ½ç†è§£ä»–äººæƒ…ç»ªèƒŒåçš„æ·±å±‚åŸå› ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘çŸ¥é“å“ªäº›å› ç´ ä¼šåŠ å‰§æˆ–ç¼“è§£ç‰¹å®šæƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘èƒ½ç”¨å‡†ç¡®çš„è¯æ±‡æè¿°ç»†å¾®çš„æƒ…ç»ªå·®å¼‚', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'understand', text: 'æˆ‘ç†è§£æ–‡åŒ–èƒŒæ™¯å¦‚ä½•å½±å“æƒ…ç»ªè¡¨è¾¾', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },

  // æƒ…ç»ªç®¡ç† Managing (10é¢˜)
  { dim: 'manage', text: 'å½“æ„Ÿåˆ°æ„¤æ€’æ—¶ï¼Œæˆ‘èƒ½å¤Ÿè®©è‡ªå·±å†·é™ä¸‹æ¥', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½æœ‰æ•ˆåœ°å®‰æ…°å¤„äºè´Ÿé¢æƒ…ç»ªä¸­çš„æœ‹å‹', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'é¢å¯¹å‹åŠ›æ—¶ï¼Œæˆ‘èƒ½ä¿æŒæƒ…ç»ªç¨³å®š', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½è°ƒèŠ‚è‡ªå·±çš„æƒ…ç»ªä»¥é€‚åº”ä¸åŒåœºåˆ', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'å½“æ„Ÿåˆ°ç„¦è™‘æ—¶ï¼Œæˆ‘æœ‰æœ‰æ•ˆçš„æ–¹æ³•è®©è‡ªå·±æ”¾æ¾', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½å¤Ÿè¯†åˆ«ä»–äººéœ€è¦çš„æ˜¯å€¾å¬è¿˜æ˜¯å»ºè®®ï¼Œå¹¶åšå‡ºæ°å½“å›åº”', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'é‡åˆ°æŒ«æŠ˜åï¼Œæˆ‘èƒ½è¾ƒå¿«æ¢å¤æƒ…ç»ª', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½æ§åˆ¶è‡ªå·±ä¸åœ¨æƒ…ç»ªæ¿€åŠ¨æ—¶åšå†³å®š', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½åœ¨å›¢é˜Ÿä¸­è¥é€ ç§¯æçš„æƒ…ç»ªæ°›å›´', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] },
  { dim: 'manage', text: 'æˆ‘èƒ½å°†è´Ÿé¢æƒ…ç»ªè½¬åŒ–ä¸ºå»ºè®¾æ€§çš„è¡ŒåŠ¨', options: ['éå¸¸ç¬¦åˆ', 'æ¯”è¾ƒç¬¦åˆ', 'ä¸€èˆ¬', 'ä¸å¤ªç¬¦åˆ', 'å®Œå…¨ä¸ç¬¦åˆ'] }
];

const dimInfo = {
  'perceive': { name: 'æƒ…ç»ªæ„ŸçŸ¥', icon: 'ğŸ‘ï¸', bg: '#dbeafe', color: '#3b82f6' },
  'facilitate': { name: 'æƒ…ç»ªè¿ç”¨', icon: 'âš¡', bg: '#d1fae5', color: '#10b981' },
  'understand': { name: 'æƒ…ç»ªç†è§£', icon: 'ğŸ’¡', bg: '#fef3c7', color: '#f59e0b' },
  'manage': { name: 'æƒ…ç»ªç®¡ç†', icon: 'ğŸ¯', bg: '#fce7f3', color: '#ec4899' }
};

const EQ_LEVELS = [
  { min: 160, level: 'å“è¶Š', desc: 'ä½ æ‹¥æœ‰éå¸¸å‡ºè‰²çš„æƒ…ç»ªæ™ºåŠ›ï¼Œåœ¨æƒ…ç»ªæ„ŸçŸ¥ã€è¿ç”¨ã€ç†è§£å’Œç®¡ç†å››ä¸ªç»´åº¦ä¸Šéƒ½è¡¨ç°ä¼˜å¼‚ã€‚ä½ èƒ½å¤Ÿæ•é”åœ°å¯Ÿè§‰åˆ°è‡ªå·±å’Œä»–äººæƒ…ç»ªçš„ç»†å¾®å˜åŒ–ï¼Œå¹¶å‡†ç¡®ç†è§£è¿™äº›æƒ…ç»ªèƒŒåçš„åŸå› å’Œæ„ä¹‰ã€‚ä½ å–„äºåˆ©ç”¨æƒ…ç»ªæ¥ä¿ƒè¿›æ€è€ƒå’Œå†³ç­–ï¼ŒåŒæ—¶èƒ½å¤Ÿæœ‰æ•ˆåœ°è°ƒèŠ‚è‡ªå·±çš„æƒ…ç»ªçŠ¶æ€ï¼Œåœ¨å‹åŠ›ä¸‹ä¿æŒå†·é™ã€‚åœ¨äººé™…äº¤å¾€ä¸­ï¼Œä½ çš„é«˜æƒ…å•†è®©ä½ èƒ½å¤Ÿä¸å„ç§æ€§æ ¼çš„äººå»ºç«‹è‰¯å¥½çš„å…³ç³»ï¼Œæˆä¸ºæœ‹å‹å’ŒåŒäº‹ä¿¡èµ–çš„å€¾å¬è€…å’Œæ”¯æŒè€…ã€‚ä½ çš„æƒ…ç»ªç®¡ç†èƒ½åŠ›è®©ä½ åœ¨å†²çªä¸­èƒ½å¤Ÿä¿æŒç†æ€§ï¼Œæ‰¾åˆ°åŒèµ¢çš„è§£å†³æ–¹æ¡ˆã€‚ç»§ç»­ä¿æŒè¿™ç§ä¼˜åŠ¿ï¼Œä½ å°†åœ¨é¢†å¯¼åŠ›ã€äººé™…å…³ç³»å’Œä¸ªäººå¹¸ç¦æ„Ÿæ–¹é¢è·å¾—æ›´å¤§çš„æˆå°±ã€‚' },
  { min: 130, level: 'ä¼˜ç§€', desc: 'ä½ çš„æƒ…ç»ªæ™ºåŠ›æ°´å¹³è¾ƒé«˜ï¼Œåœ¨æƒ…ç»ªæ„ŸçŸ¥å’Œç®¡ç†æ–¹é¢å…·å¤‡è‰¯å¥½çš„èƒ½åŠ›ã€‚ä½ é€šå¸¸èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«è‡ªå·±å’Œä»–äººçš„æƒ…ç»ªçŠ¶æ€ï¼Œç†è§£æƒ…ç»ªäº§ç”Ÿçš„åŸå› ï¼Œå¹¶é‡‡å–é€‚å½“çš„åº”å¯¹ç­–ç•¥ã€‚åœ¨äººé™…äº¤å¾€ä¸­ï¼Œä½ å±•ç°å‡ºè¾ƒå¼ºçš„åŒç†å¿ƒï¼Œèƒ½å¤Ÿç†è§£ä»–äººçš„å¤„å¢ƒå’Œæ„Ÿå—ï¼Œè¿™è®©ä½ åœ¨å›¢é˜Ÿä¸­å—åˆ°æ¬¢è¿ã€‚ä½ çš„æƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›è®©ä½ èƒ½å¤Ÿåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¿æŒæƒ…ç»ªç¨³å®šï¼Œå³ä½¿é¢å¯¹å‹åŠ›ä¹Ÿèƒ½å¤Ÿä¿æŒç›¸å¯¹çš„å¹³é™ã€‚åœ¨æŸäº›é«˜å‹æˆ–å¤æ‚çš„æƒ…ç»ªæƒ…å¢ƒä¸­ï¼Œç»§ç»­ç»ƒä¹ å°†å¸®åŠ©ä½ ä¿æŒæœ€ä½³çŠ¶æ€ã€‚å»ºè®®ç»§ç»­æœ‰æ„è¯†åœ°åŸ¹å…»æƒ…ç»ªè§‰å¯Ÿèƒ½åŠ›ï¼Œè¿™å°†å¸®åŠ©ä½ åœ¨å„ä¸ªæ–¹é¢å–å¾—æ›´å¤§çš„æˆåŠŸã€‚' },
  { min: 100, level: 'è‰¯å¥½', desc: 'ä½ å…·å¤‡è‰¯å¥½çš„åŸºç¡€æƒ…ç»ªæ™ºåŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤§å¤šæ•°æ—¥å¸¸ç”Ÿæ´»ä¸­çš„æƒ…ç»ªæƒ…å¢ƒã€‚ä½ å¯¹è‡ªå·±çš„æƒ…ç»ªæœ‰ä¸€å®šçš„è®¤è¯†ï¼Œèƒ½å¤Ÿåœ¨å¤§å¤šæ•°æ—¶å€™è¯†åˆ«å‡ºè‡ªå·±çš„æƒ…ç»ªçŠ¶æ€ï¼Œè™½ç„¶æœ‰æ—¶å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥ç†æ¸…å¤æ‚çš„æƒ…æ„Ÿã€‚åœ¨ä¸ä»–äººäº’åŠ¨æ—¶ï¼Œä½ é€šå¸¸èƒ½å¤Ÿæ„ŸçŸ¥åˆ°å¯¹æ–¹çš„æƒ…ç»ªï¼Œå¶å°”å¯èƒ½ä¼šå¿½ç•¥ä¸€äº›ç»†å¾®çš„ä¿¡å·ã€‚ä½ çš„æƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›è®©ä½ åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­èƒ½å¤Ÿä¿æŒç›¸å¯¹ç¨³å®šçš„æƒ…ç»ªçŠ¶æ€ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œæƒ…ç»ªæ™ºåŠ›æ˜¯å¯ä»¥é€šè¿‡å­¦ä¹ å’Œç»ƒä¹ æ¥æå‡çš„ã€‚å»ºè®®ä½ å¼€å§‹å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼Œå°è¯•ç”¨è¯­è¨€æè¿°è‡ªå·±çš„æ„Ÿå—ï¼Œè¿™å°†å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œç®¡ç†æƒ…ç»ªã€‚' },
  { min: 70, level: 'æˆé•¿ä¸­', desc: 'ä½ çš„æƒ…ç»ªæ™ºåŠ›æ­£å¤„äºç§¯æå‘å±•çš„é˜¶æ®µï¼Œåœ¨æŸäº›æ–¹é¢æœ‰ç€å¹¿é˜”çš„æˆé•¿ç©ºé—´ã€‚ä½ å¯èƒ½æœ‰æ—¶éœ€è¦æ›´å¤šæ—¶é—´æ¥å‡†ç¡®è¯†åˆ«è‡ªå·±æ­£åœ¨ç»å†çš„æƒ…ç»ªï¼Œæˆ–è€…åœ¨ç†è§£ä»–äººæƒ…ç»ªæ–¹é¢éœ€è¦æ›´å¤šç»ƒä¹ ã€‚åœ¨å‹åŠ›ä¸‹ï¼Œä½ çš„æƒ…ç»ªå¯èƒ½ä¼šæœ‰è¾ƒå¤§çš„å˜åŒ–å¹…åº¦ã€‚åœ¨äººé™…å…³ç³»ä¸­ï¼Œæœ‰æ—¶å¯èƒ½å› ä¸ºå¯¹æƒ…ç»ªä¿¡å·çš„ç†è§£ä¸åŒè€Œäº§ç”Ÿè¯¯è§£ã€‚æƒ…ç»ªæ™ºåŠ›æ˜¯ä¸€ç§å¯ä»¥åŸ¹å…»çš„èƒ½åŠ›ã€‚å»ºè®®ä½ å¼€å§‹å»ºç«‹æ¯æ—¥çš„æƒ…ç»ªè§‰å¯Ÿä¹ æƒ¯ï¼Œæ¯”å¦‚æ¯å¤©è®°å½•ä¸‰ç§æƒ…ç»ªåŠå…¶è§¦å‘å› ç´ ã€‚åŒæ—¶ï¼Œå­¦ä¹ ä¸€äº›åŸºæœ¬çš„æƒ…ç»ªè°ƒèŠ‚æŠ€å·§ï¼Œå¦‚æ·±å‘¼å¸ã€æ­£å¿µå†¥æƒ³ç­‰ï¼Œè¿™äº›éƒ½å°†å¸®åŠ©ä½ æå‡æƒ…ç»ªæ™ºåŠ›ã€‚' },
  { min: 0, level: 'æ¢ç´¢æœŸ', desc: 'ä½ çš„æƒ…ç»ªæ™ºåŠ›ç›®å‰æ­£å¤„äºæ¢ç´¢é˜¶æ®µï¼Œè¿™æ„å‘³ç€ä½ åœ¨æƒ…ç»ªæ„ŸçŸ¥ã€ç†è§£å’Œç®¡ç†æ–¹é¢æœ‰ç€ä¸°å¯Œçš„å­¦ä¹ æœºä¼šã€‚ä½ å¯èƒ½æ­£åœ¨é€æ­¥äº†è§£è‡ªå·±çš„æƒ…ç»ªååº”æ¨¡å¼ï¼Œä»¥åŠå¦‚ä½•æ›´å¥½åœ°ç†è§£ä»–äººçš„æƒ…æ„Ÿè¡¨è¾¾ã€‚åœ¨å‹åŠ›æƒ…å¢ƒä¸‹ï¼Œä½ æ­£åœ¨å­¦ä¹ å¦‚ä½•æ›´å¥½åœ°ç®¡ç†æƒ…ç»ªã€‚åœ¨äººé™…å…³ç³»ä¸­ï¼Œä½ æœ‰æœºä¼šå‘å±•æ›´æ·±å…¥çš„æƒ…æ„Ÿè¿æ¥ã€‚è¯·ç›¸ä¿¡æƒ…ç»ªæ™ºåŠ›æ˜¯å®Œå…¨å¯ä»¥é€šè¿‡å­¦ä¹ å’Œç»ƒä¹ æ¥æå‡çš„ã€‚æ¯ä¸ªäººéƒ½æœ‰èƒ½åŠ›å‘å±•æ›´é«˜çš„æƒ…ç»ªæ™ºåŠ›ã€‚å»ºè®®ä½ ä»æœ€åŸºç¡€å¼€å§‹ï¼šé¦–å…ˆå­¦ä¼šè¯†åˆ«å’Œå‘½åè‡ªå·±çš„åŸºæœ¬æƒ…ç»ªï¼ˆå¿«ä¹ã€æ‚²ä¼¤ã€æ„¤æ€’ã€ææƒ§ã€æƒŠè®¶ã€åŒæ¶ï¼‰ã€‚åŒæ—¶ï¼Œè€ƒè™‘é˜…è¯»ä¸€äº›æƒ…å•†ç›¸å…³çš„ä¹¦ç±æˆ–å‚åŠ æƒ…ç»ªç®¡ç†è¯¾ç¨‹ï¼Œè¿™å°†ä¸ºä½ æ‰“å¼€ä¸€æ‰‡æ–°çš„å¤§é—¨ã€‚' }
];

let idx = 0;
let answers = new Array(40).fill(null);
const dims = questions.map(q => q.dim);

function render() {
  const q = questions[idx];
  const info = dimInfo[q.dim];
  document.getElementById('current').textContent = idx + 1;
  document.getElementById('qNum').textContent = idx + 1;
  document.getElementById('progressFill').style.width = ((idx + 1) / 40 * 100) + '%';
  document.getElementById('dimTag').textContent = info.name;
  document.getElementById('dimTag').style.background = info.bg;
  document.getElementById('dimTag').style.color = info.color;
  document.getElementById('qText').textContent = q.text;

  let optHtml = '';
  q.options.forEach((opt, i) => {
    const selected = answers[idx] === i ? 'selected' : '';
    optHtml += `<div class="opt ${selected}" onclick="select(${i})"><div class="opt-radio"></div><div class="opt-text">${opt}</div></div>`;
  });
  document.getElementById('options').innerHTML = optHtml;
  document.getElementById('prevBtn').disabled = idx === 0;
  document.getElementById('nextBtn').textContent = idx === 39 ? 'æŸ¥çœ‹ç»“æœ' : 'ä¸‹ä¸€é¢˜';
}

function select(v) { answers[idx] = v; render(); if (idx < 39) setTimeout(() => nextQ(), 250); }
function prevQ() { if (idx > 0) { idx--; render(); } }
function nextQ() {
  if (answers[idx] === null) { alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªé€‰é¡¹'); return; }
  if (idx < 39) { idx++; render(); } else showResult();
}

function exitTest() { if (confirm('ç¡®å®šé€€å‡ºï¼Ÿç­”æ¡ˆå°†ä¸ä¼šä¿å­˜ã€‚')) { goToHome(); } }
function goToHome() {
  const userSource = sessionStorage.getItem('user_source');
  if (userSource === 'platform') { window.location.href = '../platform.html'; }
  else { window.location.href = 'index.html'; }
}
function getHomeButtonHtml() {
  const userSource = sessionStorage.getItem('user_source');
  if (userSource === 'platform') { return '<button class="restart-btn" onclick="goToHome()" style="margin-left:8px">è¿”å›æµ‹è¯•ä¸­å¿ƒ</button>'; }
  else { return '<button class="restart-btn more-tests-btn" onclick="showMoreTests()" style="margin-left:8px">æ›´å¤šæµ‹è¯•</button>'; }
}
function showMoreTests() {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `<div class="modal-content"><div class="modal-icon">ğŸ§‚</div><h3>æ›´å¤šä¸“ä¸šæµ‹è¯„</h3><p>è¯·åœ¨å®‡å®™è®¤çŸ¥ç›ç©¶æ‰€è´­ä¹°å…¶ä»–æµ‹è¯•å“¦~</p><div class="modal-buttons"><button class="modal-btn primary" onclick="closeModal()">çŸ¥é“äº†</button></div></div>`;
  document.body.appendChild(modal);
  setTimeout(() => modal.classList.add('show'), 10);
}
function closeModal() { const modal = document.querySelector('.modal-overlay'); if (modal) { modal.classList.remove('show'); setTimeout(() => modal.remove(), 300); } }

function calcScores() {
  const scores = { perceive: 0, facilitate: 0, understand: 0, manage: 0 };
  answers.forEach((v, i) => { scores[dims[i]] += (4 - v); }); // 0=éå¸¸ç¬¦åˆ=4åˆ†, 4=å®Œå…¨ä¸ç¬¦åˆ=0åˆ†
  return scores;
}

function getLevel(score, max) {
  const pct = score / max;
  if (pct >= 0.8) return { level: 'ä¼˜ç§€', color: '#059669', class: 'level-high' };
  if (pct >= 0.6) return { level: 'è‰¯å¥½', color: '#d97706', class: 'level-medium' };
  return { level: 'æœ‰æ½œåŠ›', color: '#6366f1', class: 'level-medium' };
}

function getEQLevel(total) {
  for (const l of EQ_LEVELS) { if (total >= l.min) return l; }
  return EQ_LEVELS[EQ_LEVELS.length - 1];
}

function getDimAnalysis(dim, score) {
  const analyses = {
    perceive: {
      high: 'ä½ å…·æœ‰éå¸¸æ•é”çš„æƒ…ç»ªæ„ŸçŸ¥èƒ½åŠ›ï¼Œè¿™æ˜¯æƒ…ç»ªæ™ºåŠ›çš„é‡è¦åŸºç¡€ã€‚ä½ èƒ½å¤Ÿåƒä¸€å°ç²¾å¯†çš„æƒ…ç»ªé›·è¾¾ä¸€æ ·ï¼Œå‡†ç¡®æ•æ‰åˆ°è‡ªå·±å’Œä»–äººæƒ…ç»ªçš„ç»†å¾®å˜åŒ–ã€‚æ— è®ºæ˜¯é¢éƒ¨è¡¨æƒ…ã€è¯­æ°”è¯­è°ƒè¿˜æ˜¯è‚¢ä½“è¯­è¨€ï¼Œä½ éƒ½èƒ½ä»ä¸­è¯»å‡ºä¸°å¯Œçš„æƒ…ç»ªä¿¡æ¯ã€‚è¿™ç§èƒ½åŠ›è®©ä½ åœ¨äººé™…äº¤å¾€ä¸­å æ®ä¼˜åŠ¿ï¼Œå› ä¸ºä½ æ€»èƒ½åœ¨ç¬¬ä¸€æ—¶é—´æ„ŸçŸ¥åˆ°å¯¹æ–¹çš„æƒ…ç»ªçŠ¶æ€ï¼Œä»è€Œåšå‡ºæ°å½“çš„å›åº”ã€‚ä½ å¯¹è‰ºæœ¯ã€éŸ³ä¹ç­‰ä½œå“ä¸­è•´å«çš„æƒ…æ„Ÿä¹Ÿæœ‰æ•é”çš„æ„Ÿå—åŠ›ã€‚ç»§ç»­ä¿æŒè¿™ç§æ•æ„Ÿåº¦ï¼Œå®ƒå°†æˆä¸ºä½ å»ºç«‹æ·±åº¦äººé™…å…³ç³»çš„é‡è¦èµ„äº§ã€‚',
      medium: 'ä½ çš„æƒ…ç»ªæ„ŸçŸ¥èƒ½åŠ›å¤„äºä¸­ç­‰æ°´å¹³ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹èƒ½å¤Ÿè¯†åˆ«å‡ºè‡ªå·±å’Œä»–äººçš„ä¸»è¦æƒ…ç»ªï¼Œä½†å¯¹ä¸€äº›ç»†å¾®çš„æƒ…ç»ªå˜åŒ–å¯èƒ½ä¼šæœ‰æ‰€å¿½ç•¥ã€‚ä½ æœ‰æ—¶å¯èƒ½ä¼šé”™è¿‡ä»–äººè¡¨è¾¾çš„å¾®å¦™æƒ…ç»ªä¿¡å·ï¼Œæ¯”å¦‚ç¤¼è²Œæ€§å¾®ç¬‘èƒŒåçš„ç–²æƒ«ï¼Œæˆ–è€…å¹³é™è¯­æ°”ä¸­éšè—çš„ä¸æ»¡ã€‚å»ºè®®ä½ åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­å¤šç»ƒä¹ æƒ…ç»ªè§‰å¯Ÿï¼šå½“ä¸äººäº¤è°ˆæ—¶ï¼Œæœ‰æ„è¯†åœ°è§‚å¯Ÿå¯¹æ–¹çš„é¢éƒ¨è¡¨æƒ…ã€è¯­æ°”å’Œè‚¢ä½“è¯­è¨€ï¼›æ¯å¤©èŠ±å‡ åˆ†é’Ÿåæ€è‡ªå·±å½“å¤©ç»å†çš„æƒ…ç»ªå˜åŒ–ã€‚è¿™äº›ç»ƒä¹ å°†å¸®åŠ©ä½ æå‡æƒ…ç»ªæ„ŸçŸ¥çš„æ•é”åº¦ã€‚',
      low: 'ä½ çš„æƒ…ç»ªæ„ŸçŸ¥èƒ½åŠ›ç›®å‰è¿˜æœ‰è¾ƒå¤§çš„æå‡ç©ºé—´ã€‚ä½ å¯èƒ½ç»å¸¸å¯¹è‡ªå·±æ­£åœ¨ç»å†çš„æƒ…ç»ªæ„Ÿåˆ°å›°æƒ‘ï¼Œä¸å¤ªç¡®å®šè‡ªå·±æ˜¯ç”Ÿæ°”ã€å¤±æœ›è¿˜æ˜¯åªæ˜¯ç–²æƒ«ã€‚åœ¨ç†è§£ä»–äººæƒ…ç»ªæ–¹é¢ï¼Œä½ å¯èƒ½ä¼šå¿½ç•¥å¾ˆå¤šé‡è¦çš„æƒ…ç»ªçº¿ç´¢ï¼Œæœ‰æ—¶ä¼šè¯¯è§£ä»–äººçš„æ„å›¾æˆ–æ„Ÿå—ã€‚è¿™ç§æƒ…å†µå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›äººé™…å…³ç³»ä¸­çš„è¯¯ä¼šã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œæƒ…ç»ªæ„ŸçŸ¥æ˜¯å¯ä»¥è®­ç»ƒçš„ã€‚å»ºè®®ä½ å¼€å§‹å†™æƒ…ç»ªæ—¥è®°ï¼Œæ¯å¤©è®°å½•ä½ ç»å†çš„ä¸‰ç§æƒ…ç»ªï¼Œä»¥åŠè§¦å‘è¿™äº›æƒ…ç»ªçš„äº‹ä»¶ã€‚åŒæ—¶ï¼Œå¯ä»¥å°è¯•æ­£å¿µå†¥æƒ³ï¼Œå®ƒèƒ½å¸®åŠ©ä½ æ›´åŠ å…³æ³¨å½“ä¸‹çš„å†…å¿ƒä½“éªŒï¼Œé€æ­¥æå‡æƒ…ç»ªè§‰å¯Ÿèƒ½åŠ›ã€‚'
    },
    facilitate: {
      high: 'ä½ éå¸¸å–„äºåˆ©ç”¨æƒ…ç»ªæ¥ä¿ƒè¿›æ€è€ƒã€å†³ç­–å’Œè¡ŒåŠ¨ï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§çš„æƒ…ç»ªæ™ºåŠ›èƒ½åŠ›ã€‚ä½ æ‡‚å¾—æƒ…ç»ªä¸ä»…ä»…æ˜¯éœ€è¦ç®¡ç†çš„ä¸œè¥¿ï¼Œæ›´æ˜¯å¯ä»¥åˆ©ç”¨çš„å®è´µèµ„æºã€‚å½“ä½ å¿ƒæƒ…æ„‰å¿«æ—¶ï¼Œä½ ä¼šåˆ©ç”¨è¿™ç§ç§¯æçŠ¶æ€æ¥è¿›è¡Œåˆ›é€ æ€§å·¥ä½œï¼›å½“ä½ æ„Ÿåˆ°ç„¦è™‘æ—¶ï¼Œä½ èƒ½å°†è¿™ç§èƒ½é‡è½¬åŒ–ä¸ºè¡ŒåŠ¨çš„åŠ¨åŠ›ã€‚ä½ ç†è§£ä¸åŒçš„æƒ…ç»ªé€‚åˆä¸åŒçš„ä»»åŠ¡ï¼šå¿«ä¹é€‚åˆåˆ›æ„å·¥ä½œï¼Œé€‚åº¦çš„ç´§å¼ æœ‰åŠ©äºé›†ä¸­æ³¨æ„åŠ›ã€‚ä½ è¿˜å–„äºé€šè¿‡å›å¿†æˆ–æƒ³è±¡æ¥è°ƒåŠ¨éœ€è¦çš„æƒ…ç»ªçŠ¶æ€ï¼Œè¿™è®©ä½ åœ¨å„ç§æƒ…å¢ƒä¸‹éƒ½èƒ½ä¿æŒæœ€ä½³è¡¨ç°ã€‚',
      medium: 'ä½ åœ¨åˆ©ç”¨æƒ…ç»ªä¿ƒè¿›æ€è€ƒæ–¹é¢æœ‰ä¸€å®šçš„èƒ½åŠ›ï¼Œä½†è¿˜æœ‰è¿›ä¸€æ­¥å‘å±•çš„ç©ºé—´ã€‚ä½ å¯èƒ½å·²ç»æ„è¯†åˆ°æƒ…ç»ªä¼šå½±å“ä½ çš„æ€ç»´å’Œå·¥ä½œæ•ˆç‡ï¼Œä½†è¿˜æ²¡æœ‰ç³»ç»Ÿåœ°å­¦ä¼šå¦‚ä½•ä¸»åŠ¨åˆ©ç”¨è¿™ç§å½±å“ã€‚æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šè®©ä¸é€‚åˆçš„æƒ…ç»ªå½±å“ä½ çš„å·¥ä½œï¼Œæ¯”å¦‚åœ¨éœ€è¦ç»†è‡´åˆ†ææ—¶å´å¤„äºè¿‡åº¦å…´å¥‹çš„çŠ¶æ€ã€‚å»ºè®®ä½ å¼€å§‹æœ‰æ„è¯†åœ°è§‚å¯Ÿæƒ…ç»ªä¸æ€ç»´ä¹‹é—´çš„å…³ç³»ï¼šæ³¨æ„ä»€ä¹ˆæ ·çš„æƒ…ç»ªçŠ¶æ€ä¸‹ä½ çš„åˆ›é€ åŠ›æœ€é«˜ï¼Œä»€ä¹ˆæ—¶å€™ä½ çš„é€»è¾‘åˆ†ææœ€æ¸…æ™°ã€‚ç„¶åï¼Œå­¦ä¼šåœ¨éœ€è¦æ—¶é€šè¿‡å¬éŸ³ä¹ã€è¿åŠ¨æˆ–å›å¿†ç­‰æ–¹å¼è°ƒåŠ¨ç›¸åº”çš„æƒ…ç»ªçŠ¶æ€ã€‚',
      low: 'ä½ åœ¨åˆ©ç”¨æƒ…ç»ªä¿ƒè¿›æ€è€ƒæ–¹é¢è¿˜éœ€è¦åŠ å¼ºå­¦ä¹ ã€‚ç›®å‰ï¼Œä½ å¯èƒ½æ›´å¤šåœ°æŠŠæƒ…ç»ªè§†ä¸ºå¹²æ‰°å› ç´ ï¼Œè€Œä¸æ˜¯å¯ä»¥åˆ©ç”¨çš„èµ„æºã€‚ä½ å¯èƒ½ä¼šåœ¨æƒ…ç»ªæ³¢åŠ¨æ—¶æ„Ÿåˆ°éš¾ä»¥é›†ä¸­æ³¨æ„åŠ›æˆ–åšå‡ºå†³ç­–ï¼Œå´ä¸çŸ¥é“å¦‚ä½•å°†è¿™äº›æƒ…ç»ªè½¬åŒ–ä¸ºç§¯æçš„åŠ›é‡ã€‚äº‹å®ä¸Šï¼Œæ¯ä¸€ç§æƒ…ç»ªéƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä»·å€¼ï¼šæ„¤æ€’å¯ä»¥æ¿€å‘è¡ŒåŠ¨çš„å‹‡æ°”ï¼Œæ‚²ä¼¤å¯ä»¥å¸¦æ¥æ·±å…¥çš„åæ€ï¼Œå¿«ä¹å¯ä»¥æ¿€å‘åˆ›é€ åŠ›ã€‚å»ºè®®ä½ å¼€å§‹å­¦ä¹ æƒ…ç»ªä¸è®¤çŸ¥ä¹‹é—´çš„å…³ç³»ï¼Œäº†è§£ä¸åŒæƒ…ç»ªå¦‚ä½•å½±å“æ€ç»´æ–¹å¼ã€‚å°è¯•åœ¨å¿ƒæƒ…å¥½çš„æ—¶å€™è¿›è¡Œåˆ›æ„å·¥ä½œï¼Œåœ¨å¹³é™æ—¶å¤„ç†éœ€è¦ç²¾ç¡®åˆ†æçš„ä»»åŠ¡ã€‚'
    },
    understand: {
      high: 'ä½ å¯¹æƒ…ç»ªæœ‰éå¸¸æ·±å…¥çš„ç†è§£ï¼Œèƒ½å¤Ÿæ´å¯Ÿæƒ…ç»ªäº§ç”Ÿçš„åŸå› ã€å˜åŒ–è§„å¾‹å’Œå¤æ‚çš„æƒ…ç»ªç»„åˆã€‚ä½ ç†è§£æƒ…ç»ªä¸æ˜¯å‡­ç©ºäº§ç”Ÿçš„ï¼Œè€Œæ˜¯æœ‰å…¶å†…åœ¨é€»è¾‘å’Œè§¦å‘æœºåˆ¶ã€‚ä½ èƒ½å¤Ÿå‡†ç¡®åŒºåˆ†ç›¸ä¼¼ä½†ä¸åŒçš„æƒ…ç»ªï¼Œæ¯”å¦‚æ„¤æ€’ä¸å¤±æœ›ã€ç„¦è™‘ä¸ææƒ§ã€å–œæ‚¦ä¸æ»¡è¶³ä¹‹é—´çš„ç»†å¾®å·®åˆ«ã€‚ä½ ä¹Ÿç†è§£å¤æ‚æƒ…ç»ªçš„å­˜åœ¨ï¼Œæ¯”å¦‚ä¸€ä¸ªäººå¯ä»¥åŒæ—¶æ„Ÿåˆ°éª„å‚²å’Œå†…ç–šï¼Œæˆ–è€…çˆ±ä¸æ¨äº¤ç»‡ã€‚è¿™ç§æ·±åº¦çš„æƒ…ç»ªç†è§£è®©ä½ èƒ½å¤Ÿæ›´å¥½åœ°é¢„æµ‹ä»–äººçš„æƒ…ç»ªååº”ï¼Œä¹Ÿèƒ½æ›´æœ‰æ•ˆåœ°å¸®åŠ©ä»–äººå¤„ç†æƒ…ç»ªå›°æ‰°ã€‚',
      medium: 'ä½ å¯¹æƒ…ç»ªæœ‰åŸºæœ¬çš„ç†è§£ï¼Œèƒ½å¤Ÿè¯†åˆ«ä¸»è¦çš„æƒ…ç»ªç±»å‹åŠå…¶å¸¸è§çš„è§¦å‘å› ç´ ï¼Œä½†å¯¹æƒ…ç»ªçš„å¤æ‚æ€§å’Œå˜åŒ–è§„å¾‹çš„è®¤è¯†è¿˜å¯ä»¥æ›´æ·±å…¥ã€‚ä½ å¯èƒ½æœ‰æ—¶ä¼šå›°æƒ‘äºä¸ºä»€ä¹ˆæŸä¸ªäº‹ä»¶ä¼šå¼•å‘å¦‚æ­¤å¼ºçƒˆçš„æƒ…ç»ªååº”ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆæƒ…ç»ªä¼šçªç„¶å˜åŒ–ã€‚ä½ å¯¹ä¸€äº›å¤æ‚çš„æƒ…ç»ªç»„åˆï¼ˆå¦‚çˆ±æ¨äº¤ç»‡ã€åˆæœŸå¾…åˆå®³æ€•ï¼‰å¯èƒ½è¿˜éš¾ä»¥å®Œå…¨ç†è§£ã€‚å»ºè®®ä½ æ·±å…¥å­¦ä¹ æƒ…ç»ªå¿ƒç†å­¦çš„åŸºç¡€çŸ¥è¯†ï¼Œäº†è§£ä¸åŒæƒ…ç»ªçš„åŠŸèƒ½å’Œè¿›åŒ–æ„ä¹‰ã€‚å¤šåæ€è‡ªå·±æƒ…ç»ªå˜åŒ–çš„è§„å¾‹ï¼Œå°è¯•æ‰¾å‡ºæƒ…ç»ªååº”èƒŒåçš„æ·±å±‚åŸå› ã€‚',
      low: 'ä½ å¯¹æƒ…ç»ªçš„ç†è§£ç›®å‰è¿˜åœç•™åœ¨æ¯”è¾ƒè¡¨é¢çš„å±‚æ¬¡ï¼Œè¿™å¯èƒ½ä¼šå½±å“ä½ å¤„ç†å¤æ‚æƒ…ç»ªæƒ…å¢ƒçš„èƒ½åŠ›ã€‚ä½ å¯èƒ½ç»å¸¸å¯¹è‡ªå·±æˆ–ä»–äººçš„æƒ…ç»ªååº”æ„Ÿåˆ°å›°æƒ‘ï¼Œä¸ç†è§£ä¸ºä»€ä¹ˆä¸€ä»¶"å°äº‹"ä¼šå¼•å‘å¦‚æ­¤å¤§çš„æƒ…ç»ªååº”ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆæƒ…ç»ªä¼šä»¥æŸç§æ–¹å¼å˜åŒ–ã€‚ä½ å¯èƒ½éš¾ä»¥ç”¨å‡†ç¡®çš„è¯æ±‡æè¿°ç»†å¾®çš„æƒ…ç»ªå·®å¼‚ï¼Œæ¯”å¦‚ç„¦è™‘ã€æ‹…å¿ƒå’Œææƒ§ä¹‹é—´çš„åŒºåˆ«ã€‚å»ºè®®ä½ ç³»ç»Ÿåœ°å­¦ä¹ æƒ…ç»ªçš„åŸºç¡€çŸ¥è¯†ï¼šäº†è§£åŸºæœ¬æƒ…ç»ªçš„ç§ç±»åŠå…¶åŠŸèƒ½ï¼Œå­¦ä¹ æƒ…ç»ªè¯æ±‡æ¥æ›´å‡†ç¡®åœ°æè¿°æ„Ÿå—ï¼Œç†è§£æƒ…ç»ªäº§ç”Ÿçš„è®¤çŸ¥ç†è®ºã€‚æ¨èé˜…è¯»ã€Šæƒ…ç»ªçš„è§£æã€‹ç­‰ç§‘æ™®ä¹¦ç±ï¼Œè¿™å°†å¸®åŠ©ä½ å»ºç«‹å¯¹æƒ…ç»ªçš„ç³»ç»Ÿè®¤è¯†ã€‚'
    },
    manage: {
      high: 'ä½ å…·æœ‰å‡ºè‰²çš„æƒ…ç»ªç®¡ç†èƒ½åŠ›ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°è°ƒèŠ‚è‡ªå·±çš„æƒ…ç»ªçŠ¶æ€ï¼ŒåŒæ—¶ä¹Ÿèƒ½ç§¯æå½±å“ä»–äººçš„æƒ…ç»ªã€‚å½“é¢å¯¹å‹åŠ›å’Œè´Ÿé¢æƒ…ç»ªæ—¶ï¼Œä½ æœ‰ä¸°å¯Œçš„ç­–ç•¥åº“å¯ä»¥è°ƒç”¨ï¼šæ·±å‘¼å¸ã€è½¬ç§»æ³¨æ„åŠ›ã€è®¤çŸ¥é‡æ„ã€å¯»æ±‚ç¤¾ä¼šæ”¯æŒç­‰ã€‚ä½ ä¸ä¼šè¢«æƒ…ç»ªæ·¹æ²¡ï¼Œä¹Ÿä¸ä¼šå‹æŠ‘æƒ…ç»ªï¼Œè€Œæ˜¯èƒ½å¤Ÿä»¥å¥åº·çš„æ–¹å¼è¡¨è¾¾å’Œå¤„ç†æƒ…ç»ªã€‚åœ¨å›¢é˜Ÿä¸­ï¼Œä½ ç»å¸¸æ‰®æ¼”ç€æƒ…ç»ªç¨³å®šå™¨çš„è§’è‰²ï¼Œèƒ½å¤Ÿåœ¨ç´§å¼ çš„æ°›å›´ä¸­ä¿æŒå†·é™ï¼Œå¸®åŠ©ä»–äººå¹³å¤æƒ…ç»ªã€‚ä½ çš„æƒ…ç»ªç®¡ç†èƒ½åŠ›è®©ä½ åœ¨é«˜å‹ç¯å¢ƒä¸‹ä¹Ÿèƒ½ä¿æŒè‰¯å¥½çš„åˆ¤æ–­åŠ›å’Œå†³ç­–èƒ½åŠ›ã€‚',
      medium: 'ä½ çš„æƒ…ç»ªç®¡ç†èƒ½åŠ›å¤„äºä¸­ç­‰æ°´å¹³ï¼Œåœ¨å¤§å¤šæ•°æ—¥å¸¸æƒ…å¢ƒä¸‹èƒ½å¤Ÿè¾ƒå¥½åœ°æ§åˆ¶è‡ªå·±çš„æƒ…ç»ªï¼Œä½†åœ¨é¢å¯¹é‡å¤§å‹åŠ›æˆ–å¼ºçƒˆæƒ…ç»ªæ—¶å¯èƒ½ä¼šæ„Ÿåˆ°åŠ›ä¸ä»å¿ƒã€‚ä½ å¯èƒ½æœ‰ä¸€äº›æƒ…ç»ªè°ƒèŠ‚çš„æ–¹æ³•ï¼Œä½†ç­–ç•¥è¿˜ä¸å¤Ÿä¸°å¯Œæˆ–ç†Ÿç»ƒã€‚æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šåœ¨æƒ…ç»ªæ¿€åŠ¨æ—¶è¯´å‡ºæˆ–åšå‡ºåæ‚”çš„äº‹æƒ…ã€‚ä½ åœ¨å¸®åŠ©ä»–äººç®¡ç†æƒ…ç»ªæ–¹é¢å¯èƒ½ä¹Ÿæ„Ÿåˆ°æœ‰äº›å›°éš¾ã€‚å»ºè®®ä½ æ‰©å±•ä½ çš„æƒ…ç»ªè°ƒèŠ‚ç­–ç•¥åº“ï¼šå­¦ä¹ è®¤çŸ¥é‡æ„æŠ€æœ¯ï¼Œå½“æƒ…ç»ªå¼ºçƒˆæ—¶èƒ½å¤Ÿä»ä¸åŒè§’åº¦çœ‹é—®é¢˜ï¼›ç»ƒä¹ æ­£å¿µå†¥æƒ³ï¼Œæå‡å¯¹æƒ…ç»ªçš„è§‰å¯Ÿå’Œæ¥çº³èƒ½åŠ›ï¼›å»ºç«‹å¥åº·çš„æƒ…ç»ªå®£æ³„æ¸ é“ï¼Œå¦‚è¿åŠ¨ã€å†™ä½œæˆ–ä¸ä¿¡ä»»çš„äººäº¤æµã€‚',
      low: 'ä½ çš„æƒ…ç»ªç®¡ç†èƒ½åŠ›ç›®å‰è¿˜éœ€è¦è¾ƒå¤§çš„æå‡ã€‚ä½ å¯èƒ½ç»å¸¸æ„Ÿåˆ°è¢«æƒ…ç»ªæ‰€æ§åˆ¶ï¼Œè€Œä¸æ˜¯ä½ åœ¨æ§åˆ¶æƒ…ç»ªã€‚å½“è´Ÿé¢æƒ…ç»ªå‡ºç°æ—¶ï¼Œä½ å¯èƒ½ç¼ºä¹æœ‰æ•ˆçš„ç­–ç•¥æ¥å¹³å¤è‡ªå·±ï¼Œå¯¼è‡´æƒ…ç»ªæŒç»­çš„æ—¶é—´è¿‡é•¿æˆ–å¼ºåº¦è¿‡å¤§ã€‚ä½ å¯èƒ½ä¼šåœ¨æƒ…ç»ªæ¿€åŠ¨æ—¶åšå‡ºå†²åŠ¨çš„å†³å®šï¼Œäº‹åæ„Ÿåˆ°åæ‚”ã€‚åœ¨é¢å¯¹ä»–äººçš„è´Ÿé¢æƒ…ç»ªæ—¶ï¼Œä½ å¯èƒ½ä¹Ÿæ„Ÿåˆ°ä¸çŸ¥æ‰€æªï¼Œä¸çŸ¥é“è¯¥å¦‚ä½•å®‰æ…°æˆ–å¸®åŠ©å¯¹æ–¹ã€‚å»ºè®®ä½ ä»æœ€åŸºç¡€çš„æƒ…ç»ªè°ƒèŠ‚æŠ€æœ¯å¼€å§‹å­¦ä¹ ï¼šé¦–å…ˆå­¦ä¼šæ·±å‘¼å¸å’Œèº«ä½“æ”¾æ¾æŠ€æœ¯ï¼Œè¿™æ˜¯åœ¨æƒ…ç»ªæ¿€åŠ¨æ—¶æœ€å¿«é€Ÿæœ‰æ•ˆçš„æ–¹æ³•ï¼›å…¶æ¬¡å­¦ä¹ "æš‚åœ"æŠ€æœ¯ï¼Œåœ¨æƒ…ç»ªå¼ºçƒˆæ—¶ç»™è‡ªå·±ä¸€äº›æ—¶é—´å†·é™ä¸‹æ¥å†åšååº”ï¼›åŒæ—¶å»ºè®®è€ƒè™‘é˜…è¯»æƒ…ç»ªç®¡ç†ç›¸å…³ä¹¦ç±æˆ–å‚åŠ ç›¸å…³è¯¾ç¨‹ã€‚'
    }
  };
  const pct = score / 40;
  if (pct >= 0.7) return analyses[dim].high;
  if (pct >= 0.5) return analyses[dim].medium;
  return analyses[dim].low;
}

function showResult() {
  document.getElementById('testPage').classList.remove('active');
  document.getElementById('resultPage').classList.add('active');

  const scores = calcScores();
  const total = scores.perceive + scores.facilitate + scores.understand + scores.manage;
  const eqLevel = getEQLevel(total);
  const psychAges = getPsychologicalAges(scores, userAge);

  const html = `
    <div class="card" style="text-align:center;">
      <div style="font-size:14px;color:var(--text-muted);margin-bottom:8px;">ä½ çš„æƒ…ç»ªæ™ºåŠ›åˆ†æ•°</div>
      <div class="eq-score">${total}</div>
      <div class="eq-level">${eqLevel.level}</div>
      <div class="eq-desc">${eqLevel.desc}</div>
      <div class="stat-grid">
        <div class="stat-card"><div class="stat-value">${scores.perceive}</div><div class="stat-label">æƒ…ç»ªæ„ŸçŸ¥</div></div>
        <div class="stat-card"><div class="stat-value">${scores.facilitate}</div><div class="stat-label">æƒ…ç»ªè¿ç”¨</div></div>
        <div class="stat-card"><div class="stat-value">${scores.understand}</div><div class="stat-label">æƒ…ç»ªç†è§£</div></div>
        <div class="stat-card"><div class="stat-value">${scores.manage}</div><div class="stat-label">æƒ…ç»ªç®¡ç†</div></div>
      </div>
    </div>

    <div class="card">
      <div class="section-title"><div class="section-icon" style="background:#fce7f3">ğŸ‚</div>ä½ çš„å¿ƒç†å¹´é¾„åˆ†æ</div>
      <div class="psych-age-main">
        <div class="psych-age-main-label">å®é™…å¹´é¾„ ${psychAges.realAge} å² Â· ç»¼åˆå¿ƒç†å¹´é¾„</div>
        <div class="psych-age-main-value">${psychAges.avgPsychAge}<span style="font-size:24px;"> å²</span></div>
        <div class="psych-age-main-type">ğŸŒŸ ${psychAges.mainType}</div>
        <div class="psych-age-main-desc">${psychAges.mainDesc}</div>
      </div>

      <div style="font-size:15px;font-weight:600;margin-bottom:16px;color:var(--text);">ä¸åŒåœºæ™¯ä¸‹çš„å¿ƒç†å¹´é¾„</div>
      <div class="psych-age-grid">
        ${Object.values(psychAges.scenes).map(scene => `
          <div class="psych-age-card">
            <div class="psych-age-icon">${scene.icon}</div>
            <div class="psych-age-label">${scene.label}</div>
            <div class="psych-age-value">${scene.age}<span class="psych-age-suffix"> å²</span></div>
            <div class="psych-age-desc">${scene.desc}</div>
          </div>
        `).join('')}
      </div>

      <div style="margin-top:20px;padding:16px;background:linear-gradient(135deg,#fef3c7 0%,#fce7f3 100%);border-radius:12px;">
        <div style="font-size:14px;font-weight:600;margin-bottom:8px;display:flex;align-items:center;gap:8px;">ğŸ’¡ å¿ƒç†å¹´é¾„è§£è¯»</div>
        <div style="font-size:13px;color:var(--text-muted);line-height:1.7;">
          å¿ƒç†å¹´é¾„åæ˜ çš„æ˜¯ä½ åœ¨æƒ…ç»ªå¤„ç†ä¸Šçš„æˆç†Ÿç¨‹åº¦ã€‚åœ¨èŒåœºä¸Šï¼Œä½ çš„å¿ƒç†å¹´é¾„æ˜¯ <strong>${psychAges.scenes.workplace.age}å²</strong>ï¼Œè¯´æ˜ä½ åœ¨å·¥ä½œä¸­${psychAges.scenes.workplace.age >= psychAges.realAge ? 'å±•ç°å‡ºè¶…è¶Šå¹´é¾„çš„æˆç†Ÿç¨³é‡' : 'è¿˜æœ‰æˆé•¿ç©ºé—´'}ï¼›åœ¨å®¶åº­å…³ç³»ä¸­ï¼Œä½ çš„å¿ƒç†å¹´é¾„æ˜¯ <strong>${psychAges.scenes.family.age}å²</strong>ï¼Œ${psychAges.scenes.family.age >= psychAges.realAge ? 'ä½ æ˜¯å®¶äººçœ¼ä¸­å€¼å¾—ä¿¡èµ–çš„å­˜åœ¨' : 'ä½ æ­£åœ¨å­¦ä¹ å¦‚ä½•æ›´å¥½åœ°å¤„ç†å®¶åº­æƒ…æ„Ÿ'}ï¼›åœ¨æ„Ÿæƒ…æ–¹é¢ï¼Œä½ çš„å¿ƒç†å¹´é¾„æ˜¯ <strong>${psychAges.scenes.romance.age}å²</strong>ï¼Œ${psychAges.scenes.romance.age >= psychAges.realAge ? 'ä½ åœ¨æƒ…æ„Ÿå…³ç³»ä¸­å±•ç°å‡ºæ™ºæ…§å’Œæ·±åº¦' : 'ä½ æ­£åœ¨æ¢ç´¢å¦‚ä½•æ›´æˆç†Ÿåœ°ç»è¥äº²å¯†å…³ç³»'}ï¼›é¢å¯¹æŒ«æŠ˜æ—¶ï¼Œä½ çš„å¿ƒç†å¹´é¾„æ˜¯ <strong>${psychAges.scenes.adversity.age}å²</strong>ï¼Œ${psychAges.scenes.adversity.age >= psychAges.realAge ? 'ä½ æœ‰ç€è¶…è¶Šå¹´é¾„çš„éŸ§æ€§å’Œå¤åŸåŠ›' : 'ä½ æ­£åœ¨ç§¯ç´¯åº”å¯¹å›°éš¾çš„æ™ºæ…§å’Œç»éªŒ'}ã€‚
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title"><div class="section-icon" style="background:#dbeafe">ğŸ“Š</div>å››ç»´åº¦è¯¦ç»†åˆ†æ</div>
      <div class="chart-container"><canvas id="radarChart"></canvas></div>
      ${Object.keys(dimInfo).map(d => {
        const info = dimInfo[d];
        const score = scores[d];
        const lv = getLevel(score, 40);
        return `
          <div class="dim-item">
            <div class="dim-header">
              <div class="dim-name"><div class="dim-icon" style="background:${info.bg}">${info.icon}</div>${info.name}</div>
              <div style="display:flex;align-items:center;gap:10px;">
                <span class="level-badge ${lv.class}">${lv.level}</span>
                <span class="dim-score">${score}/40</span>
              </div>
            </div>
            <div class="dim-bar"><div class="dim-bar-fill" style="width:${(score/40)*100}%;background:${info.color}"></div></div>
            <div class="dim-analysis">${getDimAnalysis(d, score)}</div>
          </div>
        `;
      }).join('')}
    </div>

    <div class="card">
      <div class="section-title"><div class="section-icon" style="background:#d1fae5">ğŸ’¡</div>æå‡å»ºè®®</div>
      <div class="tip-item"><div class="tip-num">1</div><div class="tip-text">æ¯å¤©èŠ±5åˆ†é’Ÿå†™æƒ…ç»ªæ—¥è®°ï¼Œè®°å½•å½“å¤©ç»å†çš„ä¸»è¦æƒ…ç»ªåŠå…¶è§¦å‘å› ç´ </div></div>
      <div class="tip-item"><div class="tip-num">2</div><div class="tip-text">ç»ƒä¹ æ­£å¿µå†¥æƒ³ï¼Œå¢å¼ºå¯¹å½“ä¸‹æƒ…ç»ªçŠ¶æ€çš„è§‰å¯Ÿèƒ½åŠ›</div></div>
      <div class="tip-item"><div class="tip-num">3</div><div class="tip-text">åœ¨æ„Ÿåˆ°å¼ºçƒˆæƒ…ç»ªæ—¶ï¼Œå°è¯•"æš‚åœ-å‘¼å¸-é€‰æ‹©"çš„ä¸‰æ­¥æ³•</div></div>
      <div class="tip-item"><div class="tip-num">4</div><div class="tip-text">é˜…è¯»æƒ…ç»ªæ™ºåŠ›ç›¸å…³ä¹¦ç±ï¼Œå¦‚ã€Šæƒ…å•†ã€‹ã€Šéæš´åŠ›æ²Ÿé€šã€‹ç­‰</div></div>
      <div class="tip-item"><div class="tip-num">5</div><div class="tip-text">ä¸»åŠ¨å¯»æ±‚åé¦ˆï¼Œäº†è§£è‡ªå·±çš„æƒ…ç»ªè¡¨è¾¾å¯¹ä»–äººçš„å½±å“</div></div>
    </div>

    <div class="card download-section">
      <button class="download-btn" onclick="downloadPDF()" id="dlBtn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>ä¸‹è½½PDFæŠ¥å‘Š</button>
      <button class="restart-btn" onclick="restart()">é‡æ–°æµ‹è¯•</button>
      ${getHomeButtonHtml()}
    </div>
  `;

  document.getElementById('resultContent').innerHTML = html;

  setTimeout(() => {
    new Chart(document.getElementById('radarChart'), {
      type: 'radar',
      data: {
        labels: ['æƒ…ç»ªæ„ŸçŸ¥', 'æƒ…ç»ªè¿ç”¨', 'æƒ…ç»ªç†è§£', 'æƒ…ç»ªç®¡ç†'],
        datasets: [{ data: [scores.perceive, scores.facilitate, scores.understand, scores.manage], backgroundColor: 'rgba(102, 126, 234, 0.2)', borderColor: 'rgba(102, 126, 234, 1)', borderWidth: 2, pointBackgroundColor: 'rgba(102, 126, 234, 1)' }]
      },
      options: { scales: { r: { beginAtZero: true, max: 40, ticks: { stepSize: 10 } } }, plugins: { legend: { display: false } } }
    });
  }, 100);
}

function restart() { if (confirm('ç¡®å®šè¦é‡æ–°æµ‹è¯•å—ï¼Ÿ')) location.reload(); }

async function downloadPDF() {
  const btn = document.getElementById('dlBtn');
  const loading = document.getElementById('loading');
  btn.disabled = true; btn.innerHTML = 'ç”Ÿæˆä¸­...'; loading.classList.add('show');
  try {
    const scores = calcScores();
    const total = scores.perceive + scores.facilitate + scores.understand + scores.manage;
    const eqLevel = getEQLevel(total);
    const date = new Date().toLocaleDateString('zh-CN');

    const pdfContainer = document.createElement('div');
    pdfContainer.style.cssText = 'position:absolute;left:-9999px;top:0;width:800px;background:#fff;padding:40px;font-family:"Noto Sans SC",sans-serif;';
    pdfContainer.innerHTML = `
      <div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:50px 40px;margin:-40px -40px 30px -40px;text-align:center;color:#fff;">
        <div style="font-size:16px;margin-bottom:10px;opacity:0.9;">å®‡å®™è®¤çŸ¥ç›ç©¶æ‰€ Â· Space Salt Lab</div>
        <div style="font-size:32px;font-weight:700;margin-bottom:15px;">æƒ…ç»ªæ™ºåŠ›æµ‹è¯„æŠ¥å‘Š</div>
        <div style="font-size:14px;opacity:0.8;">æµ‹è¯„æ—¥æœŸï¼š${date}</div>
      </div>
      <div style="text-align:center;margin-bottom:25px;">
        <div style="font-size:14px;color:#64748b;margin-bottom:8px;">ä½ çš„æƒ…ç»ªæ™ºåŠ›åˆ†æ•°</div>
        <div style="font-size:56px;font-weight:700;color:#667eea;">${total}</div>
        <div style="display:inline-block;padding:8px 24px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:20px;font-weight:600;">${eqLevel.level}</div>
        <div style="color:#64748b;font-size:14px;line-height:1.8;margin-top:16px;max-width:600px;margin-left:auto;margin-right:auto;">${eqLevel.desc}</div>
      </div>
      <div style="display:flex;gap:15px;margin-bottom:25px;">
        ${Object.keys(dimInfo).map(d => {
          const lv = getLevel(scores[d], 40);
          return `<div style="flex:1;background:#f8fafc;border-radius:12px;padding:20px;text-align:center;">
            <div style="font-size:28px;font-weight:700;color:#667eea;">${scores[d]}</div>
            <div style="font-size:12px;color:#64748b;">${dimInfo[d].name}</div>
            <div style="font-size:11px;color:${lv.color};margin-top:4px;">${lv.level}</div>
          </div>`;
        }).join('')}
      </div>
      <div style="margin-bottom:25px;">
        <div style="font-size:18px;font-weight:600;margin-bottom:15px;">ğŸ“Š å››ç»´åº¦è¯¦ç»†åˆ†æ</div>
        ${Object.keys(dimInfo).map(d => {
          const info = dimInfo[d];
          const score = scores[d];
          const lv = getLevel(score, 40);
          return `<div style="margin-bottom:16px;padding:16px;background:#f8fafc;border-radius:12px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
              <span style="font-weight:600;">${info.icon} ${info.name}</span>
              <span style="color:${lv.color};font-weight:500;">${score}/40 Â· ${lv.level}</span>
            </div>
            <div style="height:8px;background:#e2e8f0;border-radius:4px;overflow:hidden;margin-bottom:10px;">
              <div style="height:100%;width:${(score/40)*100}%;background:${info.color};border-radius:4px;"></div>
            </div>
            <div style="font-size:13px;color:#64748b;line-height:1.7;">${getDimAnalysis(d, score)}</div>
          </div>`;
        }).join('')}
      </div>
      <div style="margin-bottom:25px;">
        <div style="font-size:18px;font-weight:600;margin-bottom:15px;">ğŸ’¡ æå‡å»ºè®®</div>
        <div style="padding:12px 16px;background:#f8fafc;border-radius:8px;margin-bottom:8px;border-left:4px solid #667eea;font-size:14px;color:#64748b;">æ¯å¤©èŠ±5åˆ†é’Ÿå†™æƒ…ç»ªæ—¥è®°ï¼Œè®°å½•å½“å¤©ç»å†çš„ä¸»è¦æƒ…ç»ªåŠå…¶è§¦å‘å› ç´ </div>
        <div style="padding:12px 16px;background:#f8fafc;border-radius:8px;margin-bottom:8px;border-left:4px solid #667eea;font-size:14px;color:#64748b;">ç»ƒä¹ æ­£å¿µå†¥æƒ³ï¼Œå¢å¼ºå¯¹å½“ä¸‹æƒ…ç»ªçŠ¶æ€çš„è§‰å¯Ÿèƒ½åŠ›</div>
        <div style="padding:12px 16px;background:#f8fafc;border-radius:8px;margin-bottom:8px;border-left:4px solid #667eea;font-size:14px;color:#64748b;">åœ¨æ„Ÿåˆ°å¼ºçƒˆæƒ…ç»ªæ—¶ï¼Œå°è¯•"æš‚åœ-å‘¼å¸-é€‰æ‹©"çš„ä¸‰æ­¥æ³•</div>
        <div style="padding:12px 16px;background:#f8fafc;border-radius:8px;margin-bottom:8px;border-left:4px solid #667eea;font-size:14px;color:#64748b;">é˜…è¯»æƒ…ç»ªæ™ºåŠ›ç›¸å…³ä¹¦ç±ï¼Œå¦‚ã€Šæƒ…å•†ã€‹ã€Šéæš´åŠ›æ²Ÿé€šã€‹ç­‰</div>
      </div>
      <div style="background:#f8fafc;border-radius:12px;padding:20px;text-align:center;color:#94a3b8;font-size:12px;">
        <div style="margin-bottom:8px;font-weight:500;">å®‡å®™è®¤çŸ¥ç›ç©¶æ‰€ Â· Space Salt Lab</div>
        <div>æœ¬æŠ¥å‘Šä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆå¿ƒç†è¯Šæ–­</div>
      </div>
    `;
    document.body.appendChild(pdfContainer);
    await document.fonts.ready;
    await new Promise(r => setTimeout(r, 500));
    const canvas = await html2canvas(pdfContainer, {
      scale: 2,
      useCORS: true,
      backgroundColor: '#ffffff',
      height: pdfContainer.scrollHeight,
      windowHeight: pdfContainer.scrollHeight
    });
    document.body.removeChild(pdfContainer);

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p', 'mm', 'a4');
    const imgData = canvas.toDataURL('image/jpeg', 0.95);
    const pdfW = 210, pdfH = 297;
    const imgW = canvas.width, imgH = canvas.height;
    const ratio = imgW / imgH;
    let finalW = pdfW - 20;
    let finalH = finalW / ratio;

    if (finalH <= pdfH - 20) {
      pdf.addImage(imgData, 'JPEG', 10, 10, finalW, finalH);
    } else {
      let remainingH = imgH, srcY = 0;
      const pagePixelH = (pdfH - 20) / finalH * imgH;
      while (remainingH > 0) {
        const sliceH = Math.min(remainingH, pagePixelH);
        const sliceCanvas = document.createElement('canvas');
        sliceCanvas.width = imgW;
        sliceCanvas.height = sliceH;
        sliceCanvas.getContext('2d').drawImage(canvas, 0, srcY, imgW, sliceH, 0, 0, imgW, sliceH);
        const sliceData = sliceCanvas.toDataURL('image/jpeg', 0.95);
        if (srcY > 0) pdf.addPage();
        pdf.addImage(sliceData, 'JPEG', 10, 10, finalW, finalW / (imgW / sliceH));
        srcY += sliceH;
        remainingH -= sliceH;
      }
    }
    pdf.save(`æƒ…ç»ªæ™ºåŠ›æµ‹è¯„æŠ¥å‘Š_${total}åˆ†_${date}.pdf`);
  } catch (e) { console.error(e); alert('PDFç”Ÿæˆå¤±è´¥'); }
  finally { btn.disabled = false; btn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg> ä¸‹è½½PDFæŠ¥å‘Š'; loading.classList.remove('show'); }
}

render();
</script>
</body>
</html>
